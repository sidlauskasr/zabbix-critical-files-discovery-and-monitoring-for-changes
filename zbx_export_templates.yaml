zabbix_export:
  version: '6.0'
  date: '2022-09-22T07:53:06Z'
  groups:
    -
      uuid: dc579cd7a1a34222933f24f52a68bcd8
      name: 'Linux servers'
  templates:
    -
      uuid: 31052f8a1f8e4d1e8cb833e09d49f144
      template: 'Template for critical files changes monitor'
      name: 'Template for critical files changes monitor'
      groups:
        -
          name: 'Linux servers'
      discovery_rules:
        -
          uuid: 06890b15cb654a76a90c3088a91753e2
          name: 'Checksum of {#FILE} discovery'
          key: 'system.run[find /etc/* -maxdepth 0 -type f]'
          delay: 1d
          item_prototypes:
            -
              uuid: 858207496baa4d629664b9fa8b28a569
              name: 'Checksum of {#FILE}'
              key: 'vfs.file.cksum[{#FILE}]'
              delay: 1h
              trigger_prototypes:
                -
                  uuid: 6fcf13f56d744864be0010cf48e2aa1f
                  expression: 'change(/Template for critical files changes monitor/vfs.file.cksum[{#FILE}])>0'
                  name: '{#FILE} has been changed on {HOST.NAME}'
                  priority: AVERAGE
          preprocessing:
            -
              type: JAVASCRIPT
              parameters:
                - |
                  var lld = [];
                  var lines = value.split("\n");
                  var lines_num = lines.length;
                  for (i = 0; i < lines_num; i++)
                  {
                    var row = {};
                    row["{#FILE}"] = lines[i]
                    lld.push(row);
                  }
                  return JSON.stringify(lld);
        -
          uuid: 2d2df69276e4461f90b4c76c11d4c734
          name: 'Checksum of elasticsearch crtical files discovery'
          key: 'system.run[find /etc/elasticsearch/ -name "*.conf"]'
          delay: 1d
          item_prototypes:
            -
              uuid: ebfc7f36689541709e9408fbfd83dbb7
              name: 'Checksum of {#elasticsearch_FILE}'
              key: 'vfs.file.cksum[{#elasticsearch_FILE}]'
              delay: 1h
              trigger_prototypes:
                -
                  uuid: f16b1eab3fe449b9869bc9f8a7ec7a7c
                  expression: 'change(/Template for critical files changes monitor/vfs.file.cksum[{#elasticsearch_FILE}])>0'
                  name: '{#elasticsearch_FILE} has been changed on {HOST.NAME}'
                  priority: AVERAGE
          preprocessing:
            -
              type: JAVASCRIPT
              parameters:
                - |
                  var lld = [];
                  var lines = value.split("\n");
                  var lines_num = lines.length;
                  for (i = 0; i < lines_num; i++)
                  {
                    var row = {};
                    row["{#elasticsearch_FILE}"] = lines[i]
                    lld.push(row);
                  }
                  return JSON.stringify(lld);
        -
          uuid: 0d14705d03564044a42f6a50e69203b8
          name: 'Checksum of haproxy crtical files discovery'
          key: 'system.run[find /etc/haproxy/ -name "*.conf"]'
          delay: 1d
          item_prototypes:
            -
              uuid: cd4985f5823e4fc2b33c48de3e522e77
              name: 'Checksum of {#haproxy_FILE}'
              key: 'vfs.file.cksum[{#haproxy_FILE}]'
              delay: 1h
              trigger_prototypes:
                -
                  uuid: 183bd7df8348470386219fa5bdc5ede5
                  expression: 'change(/Template for critical files changes monitor/vfs.file.cksum[{#haproxy_FILE}])>0'
                  name: '{#haproxy_FILE} has been changed on {HOST.NAME}'
                  priority: AVERAGE
          preprocessing:
            -
              type: JAVASCRIPT
              parameters:
                - |
                  var lld = [];
                  var lines = value.split("\n");
                  var lines_num = lines.length;
                  for (i = 0; i < lines_num; i++)
                  {
                    var row = {};
                    row["{#haproxy_FILE}"] = lines[i]
                    lld.push(row);
                  }
                  return JSON.stringify(lld);
        -
          uuid: f5ef7d9ab73547c3a828a6b41b5b6d88
          name: 'Checksum of ipsec.d crtical files discovery'
          key: 'system.run[find /etc/ipsec.d/ -name "*.conf"]'
          delay: 1d
          item_prototypes:
            -
              uuid: b5daa91a13a74b219f37835514226732
              name: 'Checksum of {#ipsec_FILE}'
              key: 'vfs.file.cksum[{#ipsec_FILE}]'
              delay: 1h
              trigger_prototypes:
                -
                  uuid: 879aa582c9db480eb95c3225312f758c
                  expression: 'change(/Template for critical files changes monitor/vfs.file.cksum[{#ipsec_FILE}])>0'
                  name: '{#ipsec_FILE} has been changed on {HOST.NAME}'
                  priority: AVERAGE
          preprocessing:
            -
              type: JAVASCRIPT
              parameters:
                - |
                  var lld = [];
                  var lines = value.split("\n");
                  var lines_num = lines.length;
                  for (i = 0; i < lines_num; i++)
                  {
                    var row = {};
                    row["{#ipsec_FILE}"] = lines[i]
                    lld.push(row);
                  }
                  return JSON.stringify(lld);
        -
          uuid: b81149ba0d714472ab3097902323cc20
          name: 'Checksum of iptables crtical files discovery'
          key: 'system.run[find /etc/iptables/* -maxdepth 0 -type f]'
          delay: 1d
          item_prototypes:
            -
              uuid: 43a750f721034729aba6fc74e60a4f4d
              name: 'Checksum of {#iptables_FILE}'
              key: 'vfs.file.cksum[{#iptables_FILE}]'
              delay: 1h
              trigger_prototypes:
                -
                  uuid: 3f54d36bb9bd4445905f06517d059576
                  expression: 'change(/Template for critical files changes monitor/vfs.file.cksum[{#iptables_FILE}])>0'
                  name: '{#iptables_FILE} has been changed on {HOST.NAME}'
                  priority: AVERAGE
          preprocessing:
            -
              type: JAVASCRIPT
              parameters:
                - |
                  var lld = [];
                  var lines = value.split("\n");
                  var lines_num = lines.length;
                  for (i = 0; i < lines_num; i++)
                  {
                    var row = {};
                    row["{#iptables_FILE}"] = lines[i]
                    lld.push(row);
                  }
                  return JSON.stringify(lld);
        -
          uuid: b645943f3d424e13ae3e3ff41a561f54
          name: 'Checksum of kibana crtical files discovery'
          key: 'system.run[find /etc/kibana/ -name "*.conf"]'
          delay: 1d
          item_prototypes:
            -
              uuid: 23606fd9873a490a9fd9a1562695ce4e
              name: 'Checksum of {#kibana_FILE}'
              key: 'vfs.file.cksum[{#kibana_FILE}]'
              delay: 1h
              trigger_prototypes:
                -
                  uuid: 2adeba044846470ebc4b5e7909591c34
                  expression: 'change(/Template for critical files changes monitor/vfs.file.cksum[{#kibana_FILE}])>0'
                  name: '{#kibana_FILE} has been changed on {HOST.NAME}'
                  priority: AVERAGE
          preprocessing:
            -
              type: JAVASCRIPT
              parameters:
                - |
                  var lld = [];
                  var lines = value.split("\n");
                  var lines_num = lines.length;
                  for (i = 0; i < lines_num; i++)
                  {
                    var row = {};
                    row["{#kibana_FILE}"] = lines[i]
                    lld.push(row);
                  }
                  return JSON.stringify(lld);
        -
          uuid: 2dd63b2eaf184da9ae2e770ca1a1ac1f
          name: 'Checksum of mysql crtical files discovery'
          key: 'system.run[find /etc/mysql/ -name "*.conf"]'
          delay: 1d
          item_prototypes:
            -
              uuid: f86b77b0bedd45ee9e2be80fe61b1849
              name: 'Checksum of {#mysql_FILE}'
              key: 'vfs.file.cksum[{#mysql_FILE}]'
              delay: 1h
              trigger_prototypes:
                -
                  uuid: ccee9b18c867495f9990731f0e8ec5bc
                  expression: 'change(/Template for critical files changes monitor/vfs.file.cksum[{#mysql_FILE}])>0'
                  name: '{#mysql_FILE} has been changed on {HOST.NAME}'
                  priority: AVERAGE
          preprocessing:
            -
              type: JAVASCRIPT
              parameters:
                - |
                  var lld = [];
                  var lines = value.split("\n");
                  var lines_num = lines.length;
                  for (i = 0; i < lines_num; i++)
                  {
                    var row = {};
                    row["{#mysql_FILE}"] = lines[i]
                    lld.push(row);
                  }
                  return JSON.stringify(lld);
        -
          uuid: 515839f2f0cc4b1ea4dff782585105ad
          name: 'Checksum of nginx crtical files discovery'
          key: 'system.run[find /etc/nginx/ -name "*.conf"]'
          delay: 1d
          item_prototypes:
            -
              uuid: 40751668ead549e9adb3e4e3affa50c9
              name: 'Checksum of {#nginx_FILE}'
              key: 'vfs.file.cksum[{#nginx_FILE}]'
              delay: 1h
              trigger_prototypes:
                -
                  uuid: 9bfd51ce23204846bf5c34ae6a4ffa3b
                  expression: 'change(/Template for critical files changes monitor/vfs.file.cksum[{#nginx_FILE}])>0'
                  name: '{#nginx_FILE} has been changed on {HOST.NAME}'
                  priority: AVERAGE
          preprocessing:
            -
              type: JAVASCRIPT
              parameters:
                - |
                  var lld = [];
                  var lines = value.split("\n");
                  var lines_num = lines.length;
                  for (i = 0; i < lines_num; i++)
                  {
                    var row = {};
                    row["{#nginx_FILE}"] = lines[i]
                    lld.push(row);
                  }
                  return JSON.stringify(lld);
        -
          uuid: 05471d33d5c24597a389380e3f587188
          name: 'Checksum of rabbitmq crtical files discovery'
          key: 'system.run[find /etc/rabbitmq/ -name "*.conf"]'
          delay: 1d
          item_prototypes:
            -
              uuid: 92364f6216994d239b7259f236f9a7e0
              name: 'Checksum of {#rabbitmq_FILE}'
              key: 'vfs.file.cksum[{#rabbitmq_FILE}]'
              delay: 1h
              trigger_prototypes:
                -
                  uuid: 6d2fedc4fde84442b0aa21371d062abf
                  expression: 'change(/Template for critical files changes monitor/vfs.file.cksum[{#rabbitmq_FILE}])>0'
                  name: '{#rabbitmq_FILE} has been changed on {HOST.NAME}'
                  priority: AVERAGE
          preprocessing:
            -
              type: JAVASCRIPT
              parameters:
                - |
                  var lld = [];
                  var lines = value.split("\n");
                  var lines_num = lines.length;
                  for (i = 0; i < lines_num; i++)
                  {
                    var row = {};
                    row["{#rabbitmq_FILE}"] = lines[i]
                    lld.push(row);
                  }
                  return JSON.stringify(lld);
        -
          uuid: 958a76975f3f4ed3b6ad014ce992f91e
          name: 'Checksum of redis crtical files discovery'
          key: 'system.run[find /etc/redis/ -name "redis.conf"]'
          delay: 1d
          item_prototypes:
            -
              uuid: 625cc9f5bd144567a0829b32fe726910
              name: 'Checksum of {#redis_FILE}'
              key: 'vfs.file.cksum[{#redis_FILE}]'
              delay: 1h
              trigger_prototypes:
                -
                  uuid: 8cd31c76692f4322b893a72d560d6831
                  expression: 'change(/Template for critical files changes monitor/vfs.file.cksum[{#redis_FILE}])>0'
                  name: '{#redis_FILE} has been changed on {HOST.NAME}'
                  priority: AVERAGE
          preprocessing:
            -
              type: JAVASCRIPT
              parameters:
                - |
                  var lld = [];
                  var lines = value.split("\n");
                  var lines_num = lines.length;
                  for (i = 0; i < lines_num; i++)
                  {
                    var row = {};
                    row["{#redis_FILE}"] = lines[i]
                    lld.push(row);
                  }
                  return JSON.stringify(lld);
        -
          uuid: 88ac8c1474ff431bb7d50f0a18e51833
          name: 'Checksum of supervisor crtical files discovery'
          key: 'system.run[find /etc/supervisor/ -name "*.conf"]'
          delay: 1d
          item_prototypes:
            -
              uuid: 693da4e0ce9646a1921f548be7edf422
              name: 'Checksum of {#supervisor_FILE}'
              key: 'vfs.file.cksum[{#supervisor_FILE}]'
              delay: 1h
              trigger_prototypes:
                -
                  uuid: 4d145404672f41da9d3a85148263d238
                  expression: 'change(/Template for critical files changes monitor/vfs.file.cksum[{#supervisor_FILE}])>0'
                  name: '{#supervisor_FILE} has been changed on {HOST.NAME}'
                  priority: AVERAGE
          preprocessing:
            -
              type: JAVASCRIPT
              parameters:
                - |
                  var lld = [];
                  var lines = value.split("\n");
                  var lines_num = lines.length;
                  for (i = 0; i < lines_num; i++)
                  {
                    var row = {};
                    row["{#supervisor_FILE}"] = lines[i]
                    lld.push(row);
                  }
                  return JSON.stringify(lld);
        -
          uuid: 0b058ce4a32b47adb5bf2cc9d5ec7807
          name: 'Checksum of varnish crtical files discovery'
          key: 'system.run[find /etc/varnish/ -name "*.conf"]'
          delay: 1d
          item_prototypes:
            -
              uuid: 9b8e036f4aed4fefb2b99bed7763b11c
              name: 'Checksum of {#varnish_FILE}'
              key: 'vfs.file.cksum[{#varnish_FILE}]'
              delay: 1h
              trigger_prototypes:
                -
                  uuid: 8b364ad1c2c34a188fc442b4655eb474
                  expression: 'change(/Template for critical files changes monitor/vfs.file.cksum[{#varnish_FILE}])>0'
                  name: '{#varnish_FILE} has been changed on {HOST.NAME}'
                  priority: AVERAGE
          preprocessing:
            -
              type: JAVASCRIPT
              parameters:
                - |
                  var lld = [];
                  var lines = value.split("\n");
                  var lines_num = lines.length;
                  for (i = 0; i < lines_num; i++)
                  {
                    var row = {};
                    row["{#varnish_FILE}"] = lines[i]
                    lld.push(row);
                  }
                  return JSON.stringify(lld);
        -
          uuid: 47785e6dcc414b3b9c0e97384251acee
          name: 'Checksum of vault crtical files discovery'
          key: 'system.run[find /etc/vault/ -name "*.conf"]'
          delay: 1d
          item_prototypes:
            -
              uuid: e85e1aa7f6364828a8698c68d32dc3ac
              name: 'Checksum of {#Vault_FILE}'
              key: 'vfs.file.cksum[{#Vault_FILE}]'
              delay: 1h
              trigger_prototypes:
                -
                  uuid: 796a12feca434ae390e822c1b0a40619
                  expression: 'change(/Template for critical files changes monitor/vfs.file.cksum[{#Vault_FILE}])>0'
                  name: '{#Vault_FILE} has been changed on {HOST.NAME}'
                  priority: AVERAGE
          preprocessing:
            -
              type: JAVASCRIPT
              parameters:
                - |
                  var lld = [];
                  var lines = value.split("\n");
                  var lines_num = lines.length;
                  for (i = 0; i < lines_num; i++)
                  {
                    var row = {};
                    row["{#Vault_FILE}"] = lines[i]
                    lld.push(row);
                  }
                  return JSON.stringify(lld);
        -
          uuid: ebeb2eda8d8d43e59463b64323ff06f8
          name: 'Checksum of zabbix crtical files discovery'
          key: 'system.run[find /etc/zabbix/ -name "*.conf"]'
          delay: 1d
          item_prototypes:
            -
              uuid: 74dd7eeeda3940ccb441e85aa38607d2
              name: 'checksum of {#Zabbix_FILE}'
              key: 'vfs.file.cksum[{#Zabbix_FILE}]'
              trigger_prototypes:
                -
                  uuid: ca56579f1dc34fdbb8b1b0040610ad35
                  expression: 'change(/Template for critical files changes monitor/vfs.file.cksum[{#Zabbix_FILE}])>0'
                  name: '{#Zabbix_FILE}] has been changed on {HOST.NAME}'
                  priority: AVERAGE
          preprocessing:
            -
              type: JAVASCRIPT
              parameters:
                - |
                  var lld = [];
                  var lines = value.split("\n");
                  var lines_num = lines.length;
                  for (i = 0; i < lines_num; i++)
                  {
                    var row = {};
                    row["{#Zabbix_FILE}"] = lines[i]
                    lld.push(row);
                  }
                  return JSON.stringify(lld);
