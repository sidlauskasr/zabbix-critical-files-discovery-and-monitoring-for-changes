<?xml version="1.0" encoding="UTF-8"?>
<zabbix_export>
    <version>6.0</version>
    <date>2022-09-22T07:53:15Z</date>
    <groups>
        <group>
            <uuid>dc579cd7a1a34222933f24f52a68bcd8</uuid>
            <name>Linux servers</name>
        </group>
    </groups>
    <templates>
        <template>
            <uuid>31052f8a1f8e4d1e8cb833e09d49f144</uuid>
            <template>Template for critical files changes monitor</template>
            <name>Template for critical files changes monitor</name>
            <groups>
                <group>
                    <name>Linux servers</name>
                </group>
            </groups>
            <discovery_rules>
                <discovery_rule>
                    <uuid>06890b15cb654a76a90c3088a91753e2</uuid>
                    <name>Checksum of {#FILE} discovery</name>
                    <key>system.run[find /etc/* -maxdepth 0 -type f]</key>
                    <delay>1d</delay>
                    <item_prototypes>
                        <item_prototype>
                            <uuid>858207496baa4d629664b9fa8b28a569</uuid>
                            <name>Checksum of {#FILE}</name>
                            <key>vfs.file.cksum[{#FILE}]</key>
                            <delay>1h</delay>
                            <trigger_prototypes>
                                <trigger_prototype>
                                    <uuid>6fcf13f56d744864be0010cf48e2aa1f</uuid>
                                    <expression>change(/Template for critical files changes monitor/vfs.file.cksum[{#FILE}])&gt;0</expression>
                                    <name>{#FILE} has been changed on {HOST.NAME}</name>
                                    <priority>AVERAGE</priority>
                                </trigger_prototype>
                            </trigger_prototypes>
                        </item_prototype>
                    </item_prototypes>
                    <preprocessing>
                        <step>
                            <type>JAVASCRIPT</type>
                            <parameters>
                                <parameter>var lld = [];
var lines = value.split(&quot;\n&quot;);
var lines_num = lines.length;
for (i = 0; i &lt; lines_num; i++)
{
  var row = {};
  row[&quot;{#FILE}&quot;] = lines[i]
  lld.push(row);
}
return JSON.stringify(lld);</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                </discovery_rule>
                <discovery_rule>
                    <uuid>2d2df69276e4461f90b4c76c11d4c734</uuid>
                    <name>Checksum of elasticsearch crtical files discovery</name>
                    <key>system.run[find /etc/elasticsearch/ -name &quot;*.conf&quot;]</key>
                    <delay>1d</delay>
                    <item_prototypes>
                        <item_prototype>
                            <uuid>ebfc7f36689541709e9408fbfd83dbb7</uuid>
                            <name>Checksum of {#elasticsearch_FILE}</name>
                            <key>vfs.file.cksum[{#elasticsearch_FILE}]</key>
                            <delay>1h</delay>
                            <trigger_prototypes>
                                <trigger_prototype>
                                    <uuid>f16b1eab3fe449b9869bc9f8a7ec7a7c</uuid>
                                    <expression>change(/Template for critical files changes monitor/vfs.file.cksum[{#elasticsearch_FILE}])&gt;0</expression>
                                    <name>{#elasticsearch_FILE} has been changed on {HOST.NAME}</name>
                                    <priority>AVERAGE</priority>
                                </trigger_prototype>
                            </trigger_prototypes>
                        </item_prototype>
                    </item_prototypes>
                    <preprocessing>
                        <step>
                            <type>JAVASCRIPT</type>
                            <parameters>
                                <parameter>var lld = [];
var lines = value.split(&quot;\n&quot;);
var lines_num = lines.length;
for (i = 0; i &lt; lines_num; i++)
{
  var row = {};
  row[&quot;{#elasticsearch_FILE}&quot;] = lines[i]
  lld.push(row);
}
return JSON.stringify(lld);</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                </discovery_rule>
                <discovery_rule>
                    <uuid>0d14705d03564044a42f6a50e69203b8</uuid>
                    <name>Checksum of haproxy crtical files discovery</name>
                    <key>system.run[find /etc/haproxy/ -name &quot;*.conf&quot;]</key>
                    <delay>1d</delay>
                    <item_prototypes>
                        <item_prototype>
                            <uuid>cd4985f5823e4fc2b33c48de3e522e77</uuid>
                            <name>Checksum of {#haproxy_FILE}</name>
                            <key>vfs.file.cksum[{#haproxy_FILE}]</key>
                            <delay>1h</delay>
                            <trigger_prototypes>
                                <trigger_prototype>
                                    <uuid>183bd7df8348470386219fa5bdc5ede5</uuid>
                                    <expression>change(/Template for critical files changes monitor/vfs.file.cksum[{#haproxy_FILE}])&gt;0</expression>
                                    <name>{#haproxy_FILE} has been changed on {HOST.NAME}</name>
                                    <priority>AVERAGE</priority>
                                </trigger_prototype>
                            </trigger_prototypes>
                        </item_prototype>
                    </item_prototypes>
                    <preprocessing>
                        <step>
                            <type>JAVASCRIPT</type>
                            <parameters>
                                <parameter>var lld = [];
var lines = value.split(&quot;\n&quot;);
var lines_num = lines.length;
for (i = 0; i &lt; lines_num; i++)
{
  var row = {};
  row[&quot;{#haproxy_FILE}&quot;] = lines[i]
  lld.push(row);
}
return JSON.stringify(lld);</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                </discovery_rule>
                <discovery_rule>
                    <uuid>f5ef7d9ab73547c3a828a6b41b5b6d88</uuid>
                    <name>Checksum of ipsec.d crtical files discovery</name>
                    <key>system.run[find /etc/ipsec.d/ -name &quot;*.conf&quot;]</key>
                    <delay>1d</delay>
                    <item_prototypes>
                        <item_prototype>
                            <uuid>b5daa91a13a74b219f37835514226732</uuid>
                            <name>Checksum of {#ipsec_FILE}</name>
                            <key>vfs.file.cksum[{#ipsec_FILE}]</key>
                            <delay>1h</delay>
                            <trigger_prototypes>
                                <trigger_prototype>
                                    <uuid>879aa582c9db480eb95c3225312f758c</uuid>
                                    <expression>change(/Template for critical files changes monitor/vfs.file.cksum[{#ipsec_FILE}])&gt;0</expression>
                                    <name>{#ipsec_FILE} has been changed on {HOST.NAME}</name>
                                    <priority>AVERAGE</priority>
                                </trigger_prototype>
                            </trigger_prototypes>
                        </item_prototype>
                    </item_prototypes>
                    <preprocessing>
                        <step>
                            <type>JAVASCRIPT</type>
                            <parameters>
                                <parameter>var lld = [];
var lines = value.split(&quot;\n&quot;);
var lines_num = lines.length;
for (i = 0; i &lt; lines_num; i++)
{
  var row = {};
  row[&quot;{#ipsec_FILE}&quot;] = lines[i]
  lld.push(row);
}
return JSON.stringify(lld);</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                </discovery_rule>
                <discovery_rule>
                    <uuid>b81149ba0d714472ab3097902323cc20</uuid>
                    <name>Checksum of iptables crtical files discovery</name>
                    <key>system.run[find /etc/iptables/* -maxdepth 0 -type f]</key>
                    <delay>1d</delay>
                    <item_prototypes>
                        <item_prototype>
                            <uuid>43a750f721034729aba6fc74e60a4f4d</uuid>
                            <name>Checksum of {#iptables_FILE}</name>
                            <key>vfs.file.cksum[{#iptables_FILE}]</key>
                            <delay>1h</delay>
                            <trigger_prototypes>
                                <trigger_prototype>
                                    <uuid>3f54d36bb9bd4445905f06517d059576</uuid>
                                    <expression>change(/Template for critical files changes monitor/vfs.file.cksum[{#iptables_FILE}])&gt;0</expression>
                                    <name>{#iptables_FILE} has been changed on {HOST.NAME}</name>
                                    <priority>AVERAGE</priority>
                                </trigger_prototype>
                            </trigger_prototypes>
                        </item_prototype>
                    </item_prototypes>
                    <preprocessing>
                        <step>
                            <type>JAVASCRIPT</type>
                            <parameters>
                                <parameter>var lld = [];
var lines = value.split(&quot;\n&quot;);
var lines_num = lines.length;
for (i = 0; i &lt; lines_num; i++)
{
  var row = {};
  row[&quot;{#iptables_FILE}&quot;] = lines[i]
  lld.push(row);
}
return JSON.stringify(lld);</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                </discovery_rule>
                <discovery_rule>
                    <uuid>b645943f3d424e13ae3e3ff41a561f54</uuid>
                    <name>Checksum of kibana crtical files discovery</name>
                    <key>system.run[find /etc/kibana/ -name &quot;*.conf&quot;]</key>
                    <delay>1d</delay>
                    <item_prototypes>
                        <item_prototype>
                            <uuid>23606fd9873a490a9fd9a1562695ce4e</uuid>
                            <name>Checksum of {#kibana_FILE}</name>
                            <key>vfs.file.cksum[{#kibana_FILE}]</key>
                            <delay>1h</delay>
                            <trigger_prototypes>
                                <trigger_prototype>
                                    <uuid>2adeba044846470ebc4b5e7909591c34</uuid>
                                    <expression>change(/Template for critical files changes monitor/vfs.file.cksum[{#kibana_FILE}])&gt;0</expression>
                                    <name>{#kibana_FILE} has been changed on {HOST.NAME}</name>
                                    <priority>AVERAGE</priority>
                                </trigger_prototype>
                            </trigger_prototypes>
                        </item_prototype>
                    </item_prototypes>
                    <preprocessing>
                        <step>
                            <type>JAVASCRIPT</type>
                            <parameters>
                                <parameter>var lld = [];
var lines = value.split(&quot;\n&quot;);
var lines_num = lines.length;
for (i = 0; i &lt; lines_num; i++)
{
  var row = {};
  row[&quot;{#kibana_FILE}&quot;] = lines[i]
  lld.push(row);
}
return JSON.stringify(lld);</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                </discovery_rule>
                <discovery_rule>
                    <uuid>2dd63b2eaf184da9ae2e770ca1a1ac1f</uuid>
                    <name>Checksum of mysql crtical files discovery</name>
                    <key>system.run[find /etc/mysql/ -name &quot;*.conf&quot;]</key>
                    <delay>1d</delay>
                    <item_prototypes>
                        <item_prototype>
                            <uuid>f86b77b0bedd45ee9e2be80fe61b1849</uuid>
                            <name>Checksum of {#mysql_FILE}</name>
                            <key>vfs.file.cksum[{#mysql_FILE}]</key>
                            <delay>1h</delay>
                            <trigger_prototypes>
                                <trigger_prototype>
                                    <uuid>ccee9b18c867495f9990731f0e8ec5bc</uuid>
                                    <expression>change(/Template for critical files changes monitor/vfs.file.cksum[{#mysql_FILE}])&gt;0</expression>
                                    <name>{#mysql_FILE} has been changed on {HOST.NAME}</name>
                                    <priority>AVERAGE</priority>
                                </trigger_prototype>
                            </trigger_prototypes>
                        </item_prototype>
                    </item_prototypes>
                    <preprocessing>
                        <step>
                            <type>JAVASCRIPT</type>
                            <parameters>
                                <parameter>var lld = [];
var lines = value.split(&quot;\n&quot;);
var lines_num = lines.length;
for (i = 0; i &lt; lines_num; i++)
{
  var row = {};
  row[&quot;{#mysql_FILE}&quot;] = lines[i]
  lld.push(row);
}
return JSON.stringify(lld);</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                </discovery_rule>
                <discovery_rule>
                    <uuid>515839f2f0cc4b1ea4dff782585105ad</uuid>
                    <name>Checksum of nginx crtical files discovery</name>
                    <key>system.run[find /etc/nginx/ -name &quot;*.conf&quot;]</key>
                    <delay>1d</delay>
                    <item_prototypes>
                        <item_prototype>
                            <uuid>40751668ead549e9adb3e4e3affa50c9</uuid>
                            <name>Checksum of {#nginx_FILE}</name>
                            <key>vfs.file.cksum[{#nginx_FILE}]</key>
                            <delay>1h</delay>
                            <trigger_prototypes>
                                <trigger_prototype>
                                    <uuid>9bfd51ce23204846bf5c34ae6a4ffa3b</uuid>
                                    <expression>change(/Template for critical files changes monitor/vfs.file.cksum[{#nginx_FILE}])&gt;0</expression>
                                    <name>{#nginx_FILE} has been changed on {HOST.NAME}</name>
                                    <priority>AVERAGE</priority>
                                </trigger_prototype>
                            </trigger_prototypes>
                        </item_prototype>
                    </item_prototypes>
                    <preprocessing>
                        <step>
                            <type>JAVASCRIPT</type>
                            <parameters>
                                <parameter>var lld = [];
var lines = value.split(&quot;\n&quot;);
var lines_num = lines.length;
for (i = 0; i &lt; lines_num; i++)
{
  var row = {};
  row[&quot;{#nginx_FILE}&quot;] = lines[i]
  lld.push(row);
}
return JSON.stringify(lld);</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                </discovery_rule>
                <discovery_rule>
                    <uuid>05471d33d5c24597a389380e3f587188</uuid>
                    <name>Checksum of rabbitmq crtical files discovery</name>
                    <key>system.run[find /etc/rabbitmq/ -name &quot;*.conf&quot;]</key>
                    <delay>1d</delay>
                    <item_prototypes>
                        <item_prototype>
                            <uuid>92364f6216994d239b7259f236f9a7e0</uuid>
                            <name>Checksum of {#rabbitmq_FILE}</name>
                            <key>vfs.file.cksum[{#rabbitmq_FILE}]</key>
                            <delay>1h</delay>
                            <trigger_prototypes>
                                <trigger_prototype>
                                    <uuid>6d2fedc4fde84442b0aa21371d062abf</uuid>
                                    <expression>change(/Template for critical files changes monitor/vfs.file.cksum[{#rabbitmq_FILE}])&gt;0</expression>
                                    <name>{#rabbitmq_FILE} has been changed on {HOST.NAME}</name>
                                    <priority>AVERAGE</priority>
                                </trigger_prototype>
                            </trigger_prototypes>
                        </item_prototype>
                    </item_prototypes>
                    <preprocessing>
                        <step>
                            <type>JAVASCRIPT</type>
                            <parameters>
                                <parameter>var lld = [];
var lines = value.split(&quot;\n&quot;);
var lines_num = lines.length;
for (i = 0; i &lt; lines_num; i++)
{
  var row = {};
  row[&quot;{#rabbitmq_FILE}&quot;] = lines[i]
  lld.push(row);
}
return JSON.stringify(lld);</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                </discovery_rule>
                <discovery_rule>
                    <uuid>958a76975f3f4ed3b6ad014ce992f91e</uuid>
                    <name>Checksum of redis crtical files discovery</name>
                    <key>system.run[find /etc/redis/ -name &quot;redis.conf&quot;]</key>
                    <delay>1d</delay>
                    <item_prototypes>
                        <item_prototype>
                            <uuid>625cc9f5bd144567a0829b32fe726910</uuid>
                            <name>Checksum of {#redis_FILE}</name>
                            <key>vfs.file.cksum[{#redis_FILE}]</key>
                            <delay>1h</delay>
                            <trigger_prototypes>
                                <trigger_prototype>
                                    <uuid>8cd31c76692f4322b893a72d560d6831</uuid>
                                    <expression>change(/Template for critical files changes monitor/vfs.file.cksum[{#redis_FILE}])&gt;0</expression>
                                    <name>{#redis_FILE} has been changed on {HOST.NAME}</name>
                                    <priority>AVERAGE</priority>
                                </trigger_prototype>
                            </trigger_prototypes>
                        </item_prototype>
                    </item_prototypes>
                    <preprocessing>
                        <step>
                            <type>JAVASCRIPT</type>
                            <parameters>
                                <parameter>var lld = [];
var lines = value.split(&quot;\n&quot;);
var lines_num = lines.length;
for (i = 0; i &lt; lines_num; i++)
{
  var row = {};
  row[&quot;{#redis_FILE}&quot;] = lines[i]
  lld.push(row);
}
return JSON.stringify(lld);</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                </discovery_rule>
                <discovery_rule>
                    <uuid>88ac8c1474ff431bb7d50f0a18e51833</uuid>
                    <name>Checksum of supervisor crtical files discovery</name>
                    <key>system.run[find /etc/supervisor/ -name &quot;*.conf&quot;]</key>
                    <delay>1d</delay>
                    <item_prototypes>
                        <item_prototype>
                            <uuid>693da4e0ce9646a1921f548be7edf422</uuid>
                            <name>Checksum of {#supervisor_FILE}</name>
                            <key>vfs.file.cksum[{#supervisor_FILE}]</key>
                            <delay>1h</delay>
                            <trigger_prototypes>
                                <trigger_prototype>
                                    <uuid>4d145404672f41da9d3a85148263d238</uuid>
                                    <expression>change(/Template for critical files changes monitor/vfs.file.cksum[{#supervisor_FILE}])&gt;0</expression>
                                    <name>{#supervisor_FILE} has been changed on {HOST.NAME}</name>
                                    <priority>AVERAGE</priority>
                                </trigger_prototype>
                            </trigger_prototypes>
                        </item_prototype>
                    </item_prototypes>
                    <preprocessing>
                        <step>
                            <type>JAVASCRIPT</type>
                            <parameters>
                                <parameter>var lld = [];
var lines = value.split(&quot;\n&quot;);
var lines_num = lines.length;
for (i = 0; i &lt; lines_num; i++)
{
  var row = {};
  row[&quot;{#supervisor_FILE}&quot;] = lines[i]
  lld.push(row);
}
return JSON.stringify(lld);</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                </discovery_rule>
                <discovery_rule>
                    <uuid>0b058ce4a32b47adb5bf2cc9d5ec7807</uuid>
                    <name>Checksum of varnish crtical files discovery</name>
                    <key>system.run[find /etc/varnish/ -name &quot;*.conf&quot;]</key>
                    <delay>1d</delay>
                    <item_prototypes>
                        <item_prototype>
                            <uuid>9b8e036f4aed4fefb2b99bed7763b11c</uuid>
                            <name>Checksum of {#varnish_FILE}</name>
                            <key>vfs.file.cksum[{#varnish_FILE}]</key>
                            <delay>1h</delay>
                            <trigger_prototypes>
                                <trigger_prototype>
                                    <uuid>8b364ad1c2c34a188fc442b4655eb474</uuid>
                                    <expression>change(/Template for critical files changes monitor/vfs.file.cksum[{#varnish_FILE}])&gt;0</expression>
                                    <name>{#varnish_FILE} has been changed on {HOST.NAME}</name>
                                    <priority>AVERAGE</priority>
                                </trigger_prototype>
                            </trigger_prototypes>
                        </item_prototype>
                    </item_prototypes>
                    <preprocessing>
                        <step>
                            <type>JAVASCRIPT</type>
                            <parameters>
                                <parameter>var lld = [];
var lines = value.split(&quot;\n&quot;);
var lines_num = lines.length;
for (i = 0; i &lt; lines_num; i++)
{
  var row = {};
  row[&quot;{#varnish_FILE}&quot;] = lines[i]
  lld.push(row);
}
return JSON.stringify(lld);</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                </discovery_rule>
                <discovery_rule>
                    <uuid>47785e6dcc414b3b9c0e97384251acee</uuid>
                    <name>Checksum of vault crtical files discovery</name>
                    <key>system.run[find /etc/vault/ -name &quot;*.conf&quot;]</key>
                    <delay>1d</delay>
                    <item_prototypes>
                        <item_prototype>
                            <uuid>e85e1aa7f6364828a8698c68d32dc3ac</uuid>
                            <name>Checksum of {#Vault_FILE}</name>
                            <key>vfs.file.cksum[{#Vault_FILE}]</key>
                            <delay>1h</delay>
                            <trigger_prototypes>
                                <trigger_prototype>
                                    <uuid>796a12feca434ae390e822c1b0a40619</uuid>
                                    <expression>change(/Template for critical files changes monitor/vfs.file.cksum[{#Vault_FILE}])&gt;0</expression>
                                    <name>{#Vault_FILE} has been changed on {HOST.NAME}</name>
                                    <priority>AVERAGE</priority>
                                </trigger_prototype>
                            </trigger_prototypes>
                        </item_prototype>
                    </item_prototypes>
                    <preprocessing>
                        <step>
                            <type>JAVASCRIPT</type>
                            <parameters>
                                <parameter>var lld = [];
var lines = value.split(&quot;\n&quot;);
var lines_num = lines.length;
for (i = 0; i &lt; lines_num; i++)
{
  var row = {};
  row[&quot;{#Vault_FILE}&quot;] = lines[i]
  lld.push(row);
}
return JSON.stringify(lld);</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                </discovery_rule>
                <discovery_rule>
                    <uuid>ebeb2eda8d8d43e59463b64323ff06f8</uuid>
                    <name>Checksum of zabbix crtical files discovery</name>
                    <key>system.run[find /etc/zabbix/ -name &quot;*.conf&quot;]</key>
                    <delay>1d</delay>
                    <item_prototypes>
                        <item_prototype>
                            <uuid>74dd7eeeda3940ccb441e85aa38607d2</uuid>
                            <name>checksum of {#Zabbix_FILE}</name>
                            <key>vfs.file.cksum[{#Zabbix_FILE}]</key>
                            <trigger_prototypes>
                                <trigger_prototype>
                                    <uuid>ca56579f1dc34fdbb8b1b0040610ad35</uuid>
                                    <expression>change(/Template for critical files changes monitor/vfs.file.cksum[{#Zabbix_FILE}])&gt;0</expression>
                                    <name>{#Zabbix_FILE}] has been changed on {HOST.NAME}</name>
                                    <priority>AVERAGE</priority>
                                </trigger_prototype>
                            </trigger_prototypes>
                        </item_prototype>
                    </item_prototypes>
                    <preprocessing>
                        <step>
                            <type>JAVASCRIPT</type>
                            <parameters>
                                <parameter>var lld = [];
var lines = value.split(&quot;\n&quot;);
var lines_num = lines.length;
for (i = 0; i &lt; lines_num; i++)
{
  var row = {};
  row[&quot;{#Zabbix_FILE}&quot;] = lines[i]
  lld.push(row);
}
return JSON.stringify(lld);</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                </discovery_rule>
            </discovery_rules>
        </template>
    </templates>
</zabbix_export>
